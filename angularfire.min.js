<<<<<<< HEAD
"use strict";function AngularFire(t,e,n,r){this._q=t,this._fRef=r,this._parse=e,this._timeout=n,this._initial=!0,this._remoteValue=!1}angular.module("firebase",[]).value("Firebase",Firebase),angular.module("firebase").factory("angularFire",["$q","$parse","$timeout",function(t,e,n){return function(r,i,a){var o=new AngularFire(t,e,n,r);return o.associate(i,a)}}]),AngularFire.prototype={associate:function(t,e){var n=this,r=this._q.defer(),i=r.promise;return this._fRef.on("value",function(i){var a=i.val(),o=angular.fromJson(angular.toJson(n._parse(e)(t)));if(n._initial){n._initial=!1;var u=!1,c=Object.prototype.toString;if(a&&c.call(o)==c.call(a))if("[object Array]"==c.call(o))u=o.concat(a);else if("[object Object]"==c.call(o)){u=o;for(var s in a)u[s]=a[s]}if(null===a&&(u=o),u)return n._fRef.ref().update(u),void 0}var l=!1;r&&(l=r,r=!1),n._timeout(function(){n._resolve(t,e,l,a)})}),i},disassociate:function(){var t=this;t._unregister&&t._unregister(),this._fRef.off("value")},_resolve:function(t,e,n,r){var i=this;if(null===r){var a=t[e];if("object"==typeof a){var o=Object.prototype.toString;r=o.call(a)==o.call([])?[]:{}}}this._remoteValue=angular.copy(r),this._parse(e).assign(t,angular.copy(r)),n&&(n.resolve(function(){i.disassociate()}),this._watch(t,e))},_watch:function(t,e){var n=this;n._unregister=t.$watch(e,function(){if(!n._initial){var r=angular.fromJson(angular.toJson(n._parse(e)(t)));angular.equals(r,n._remoteValue)||n._fRef.ref().update(r)}},!0),t.$on("$destroy",function(){n.disassociate()})},_log:function(t){console&&console.log&&console.log(t)}},angular.module("firebase").factory("angularFireCollection",["$timeout",function(t){return function(e,n){function r(t,e){this.$ref=t.ref(),this.$id=t.name(),this.$index=e,angular.extend(this,{$priority:t.getPriority()},t.val())}function i(t){return t?f[t]+1:0}function a(t,e){f[e.$id]=t,h.splice(t,0,e)}function o(t){var e=f[t];h.splice(e,1),f[t]=void 0}function u(t,e){h[t]=e}function c(t,e,n){h.splice(t,1),h.splice(e,0,n),s(t,e)}function s(t,e){var n=h.length;e=e||n,e>n&&(e=n);for(var r=t;e>r;r++){var i=h[r];i.$index=f[i.$id]=r}}var l=[function(t){return null==t.$priority?0:angular.isNumber(t.$priority)?1:angular.isString(t.$priority)?2:void 0},function(t){return t.$priority?t.$priority:1/0},function(t){return t.$id}],f={},h=[];return n&&"function"==typeof n&&e.once("value",n),e.on("child_added",function(e,n){t(function(){var t=i(n);a(t,new r(e,t)),s(t)})}),e.on("child_removed",function(e){t(function(){var t=e.name(),n=f[t];o(t),s(n)})}),e.on("child_changed",function(e,n){t(function(){var t=f[e.name()],a=i(n),o=new r(e,t);u(t,o),a!==t&&c(t,a,o)})}),e.on("child_moved",function(e,n){t(function(){var t=f[e.name()],r=i(n),a=h[t];c(t,r,a)})}),h.getByName=function(t){return h[f[t]]},h.add=function(t,n){var r;return r=n?e.ref().push(t,n):e.ref().push(t)},h.remove=function(t,e){var n=angular.isString(t)?h[f[t]]:t;e?n.$ref.remove(e):n.$ref.remove()},h.update=function(t,e){var n=angular.isString(t)?h[f[t]]:t,r={};angular.forEach(n,function(t,e){0!==e.indexOf("$")&&(r[e]=t)}),e?n.$ref.set(r,e):n.$ref.set(r)},h.order=l,h}}]),angular.module("firebase").factory("angularFireAuth",["$rootScope","$parse","$timeout","$location","$route","$q",function(t,e,n,r,i,a){function o(t){var e=t.split(".");if(!e instanceof Array||3!==e.length)throw new Error("Invalid JWT");var n=e[1];return window.atob?JSON.parse(decodeURIComponent(escape(window.atob(n)))):t}function u(t,r,i,a){r&&n(function(){e(r).assign(t,i),a()})}function c(t,e,n){t.authRequired&&!n._authenticated&&(n._redirectTo=void 0===t.pathTo?r.path():t.pathTo===e?"/":t.pathTo,r.replace(),r.path(e))}return{initialize:function(e,n){var r=this;if(n=n||{},this._scope=t,!n.scope)throw new Exception("Scope not provided to angularFireAuth!");if(this._scope=n.scope,!n.name)throw new Exception("Model name not provided to angularFireAuth!");if(this._name=n.name,this._cb=function(){},n.callback&&"function"==typeof n.callback&&(this._cb=n.callback),this._redirectTo=null,this._authenticated=!1,n.path&&(i.current&&c(i.current,n.path,r),t.$on("$routeChangeStart",function(t,e){c(e,n.path,r)})),this._ref=new Firebase(e),n.simple===!1)return u(this._scope,this._name,null,function(){}),void 0;if(!window.FirebaseSimpleLogin){var a=new Error("FirebaseSimpleLogin undefined, did you include firebase-simple-login.js?");return t.$broadcast("angularFireAuth:error",a),void 0}var o=new FirebaseSimpleLogin(this._ref,function(e,n){r._cb(e,n),e?t.$broadcast("angularFireAuth:error",e):n?r._loggedIn(n):r._loggedOut()});this._authClient=o},login:function(e,n){var r=this._watchForLogin();switch(e){case"github":case"persona":case"twitter":case"facebook":case"password":if(this._authClient)this._authClient.login(e,n);else{var i=new Error("Simple Login not initialized");t.$broadcast("angularFireAuth:error",i)}break;default:var a,u=this;try{a=o(e),this._ref.auth(e,function(e){e?t.$broadcast("angularFireAuth:error",e):u._loggedIn(a)})}catch(c){t.$broadcast("angularFireAuth:error",c)}}return r},createUser:function(e,r,i,a){var o=this;this._authClient.createUser(e,r,function(u,c){try{u?t.$broadcast("angularFireAuth:error",u):a||o.login("password",{email:e,password:r})}catch(s){t.$broadcast("angularFireAuth:error",s)}i&&n(function(){i(u,c)})})},logout:function(){this._authClient?this._authClient.logout():(this._ref.unauth(),this._loggedOut())},_loggedIn:function(e){var n=this;this._authenticated=!0,u(this._scope,this._name,e,function(){t.$broadcast("angularFireAuth:login",e),n._redirectTo&&(r.replace(),r.path(n._redirectTo),n._redirectTo=null)})},_loggedOut:function(){this._authenticated=!1,u(this._scope,this._name,null,function(){t.$broadcast("angularFireAuth:logout")})},_watchForLogin:function(){function e(t,e){n(function(){t?i.reject(t):i.resolve(e)});for(var a=0;a<r.length;a++)r[a]()}var r=[],i=a.defer();return r.push(t.$on("angularFireAuth:login",function(t,n){e(null,n)})),r.push(t.$on("angularFireAuth:error",function(t,n){e(n,null)})),i.promise}}}]);
=======
"use strict";function AngularFire(e,t,r,i){this._q=e,this._parse=t,this._timeout=r,this._initial=!0,this._remoteValue=!1,this._fRef="string"==typeof i?new Firebase(i):i}angular.module("firebase",[]).value("Firebase",Firebase),angular.module("firebase").factory("angularFire",["$q","$parse","$timeout",function(e,t,r){return function(i,n,a,o){var u=new AngularFire(e,t,r,i);return u.associate(n,a,o)}}]),AngularFire.prototype={associate:function(e,t,r){var i=this;void 0==r&&(r=[]);var n=this._q.defer(),a=n.promise;return this._fRef.on("value",function(a){var o=!1;if(n&&(o=n,n=!1),i._remoteValue=r,a&&void 0!=a.val()){var u=a.val();if(typeof u!=typeof r)return i._log("Error: type mismatch"),void 0;var s=Object.prototype.toString;if(s.call(r)!=s.call(u))return i._log("Error: type mismatch"),void 0;if(i._remoteValue=angular.copy(u),angular.equals(u,i._parse(t)(e)))return}i._timeout(function(){i._resolve(e,t,o,i._remoteValue)})}),a},disassociate:function(){var e=this;e._unregister&&e._unregister(),this._fRef.off("value")},_resolve:function(e,t,r,i){var n=this;this._parse(t).assign(e,angular.copy(i)),this._remoteValue=angular.copy(i),r&&(r.resolve(function(){n.disassociate()}),this._watch(e,t))},_watch:function(e,t){var r=this;r._unregister=e.$watch(t,function(){if(r._initial)return r._initial=!1,void 0;var i=JSON.parse(angular.toJson(r._parse(t)(e)));angular.equals(i,r._remoteValue)||r._fRef.ref().set(i)},!0),e.$on("$destroy",function(){r.disassociate()})},_log:function(e){console&&console.log&&console.log(e)}},angular.module("firebase").factory("angularFireCollection",["$timeout",function(e){return function(t,r,i){function n(e,t){this.$ref=e.ref(),this.$id=e.name(),this.$index=t,angular.extend(this,{$priority:e.getPriority()},e.val())}function a(e){return e?h[e]+1:0}function o(e,t){h[t.$id]=e,d.splice(e,0,t)}function u(e){var t=h[e];d.splice(t,1),h[e]=void 0}function s(e,t){d[e]=t}function c(e,t,r){d.splice(e,1),d.splice(t,0,r),l(e,t)}function l(e,t){var r=d.length;t=t||r,t>r&&(t=r);for(var i=e;t>i;i++){var n=d[i];n.$index=h[n.$id]=i}}var f=[function(e){return null==e.$priority?0:angular.isNumber(e.$priority)?1:angular.isString(e.$priority)?2:void 0},function(e){return e.$priority?e.$priority:1/0},function(e){return e.$id}],h={},d=[],g=null;i&&"function"==typeof i&&(g=i);var _;return _="string"==typeof t?new Firebase(t):t,r&&"function"==typeof r&&_.once("value",r),_.on("child_added",function(t,r){e(function(){var e=a(r),i=new n(t,e);o(e,i),l(e),g&&g("item_added",i)})}),_.on("child_removed",function(t){e(function(){var e=t.name(),r=h[e],i=d[r];u(e),l(r),g&&g("item_removed",i)})}),_.on("child_changed",function(t,r){e(function(){var e=h[t.name()],i=a(r);g&&g("item_removed",d[e]);var o=new n(t,e);s(e,o),i!==e&&c(e,i,o),g&&g("item_added",o)})}),_.on("child_moved",function(t,r){e(function(){var e=h[t.name()],i=a(r),n=d[e];c(e,i,n),g&&g("item_moved",n)})}),d.getByName=function(e){return d[h[e]]},d.add=function(e,t){var r;return r=t?_.ref().push(e,t):_.ref().push(e)},d.remove=function(e,t){var r=angular.isString(e)?d[h[e]]:e;t?r.$ref.remove(t):r.$ref.remove()},d.update=function(e,t){var r=angular.isString(e)?d[h[e]]:e,i={};angular.forEach(r,function(e,t){0!==t.indexOf("$")&&(i[t]=e)}),t?r.$ref.set(i,t):r.$ref.set(i)},d.order=f,d}}]),angular.module("firebase").factory("angularFireAuth",["$rootScope","$parse","$timeout","$location","$route","$q",function(e,t,r,i,n,a){function o(e){var t=e.split(".");if(!t instanceof Array||3!==t.length)throw new Error("Invalid JWT");var r=t[1];return JSON.parse(decodeURIComponent(escape(window.atob(r))))}function u(e,i,n,a){i&&r(function(){t(i).assign(e,n),a()})}function s(e,t,r){e.authRequired&&!r._authenticated&&(r._redirectTo=void 0===e.pathTo?i.path():e.pathTo===t?"/":e.pathTo,i.replace(),i.path(t))}return{initialize:function(t,r){var i=this;if(r=r||{},this._scope=e,r.scope&&(this._scope=r.scope),r.name&&(this._name=r.name),this._cb=function(){},r.callback&&"function"==typeof r.callback&&(this._cb=r.callback),this._redirectTo=null,this._authenticated=!1,r.path&&(n.current&&s(n.current,r.path,i),e.$on("$routeChangeStart",function(e,t){s(t,r.path,i)})),this._ref=new Firebase(t),r.simple&&r.simple===!1)return u(this._scope,this._name,null),void 0;if(!window.FirebaseSimpleLogin){var a=new Error("FirebaseSimpleLogin undefined, did you include firebase-simple-login.js?");return e.$broadcast("angularFireAuth:error",a),void 0}var o=new FirebaseSimpleLogin(this._ref,function(t,r){i._cb(t,r),t?e.$broadcast("angularFireAuth:error",t):r?i._loggedIn(r):i._loggedOut()});this._authClient=o},login:function(t,r){var i=this._watchForLogin();switch(t){case"github":case"persona":case"twitter":case"facebook":case"password":if(this._authClient)this._authClient.login(t,r);else{var n=new Error("Simple Login not initialized");e.$broadcast("angularFireAuth:error",n)}break;default:var a,u=this;try{a=o(t),this._ref.auth(t,function(t){t?e.$broadcast("angularFireAuth:error",t):u._loggedIn(a)})}catch(s){e.$broadcast("angularFireAuth:error",s)}}return i},createUser:function(t,i,n){var a=this;this._authClient.createUser(t,i,function(t,i){try{t?e.$broadcast("angularFireAuth:error",t):a._loggedIn(i)}catch(o){e.$broadcast("angularFireAuth:error",o)}n&&r(function(){n(i)})})},logout:function(){this._authClient?this._authClient.logout():(this._ref.unauth(),this._loggedOut())},_loggedIn:function(t){var r=this;this._authenticated=!0,u(this._scope,this._name,t,function(){e.$broadcast("angularFireAuth:login",t),r._redirectTo&&(i.replace(),i.path(r._redirectTo),r._redirectTo=null)})},_loggedOut:function(){this._authenticated=!1,u(this._scope,this._name,null,function(){e.$broadcast("angularFireAuth:logout")})},_watchForLogin:function(){function t(e,t){r(function(){e?n.reject(e):n.resolve(t)});for(var a=0;a<i.length;a++)i[a]()}var i=[],n=a.defer();return i.push(e.$on("angularFireAuth:login",function(e,r){t(null,r)})),i.push(e.$on("angularFireAuth:error",function(e,r){t(r,null)})),n.promise}}}]);
>>>>>>> Add on change callback
