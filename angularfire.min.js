"use strict";function AngularFire(e,t,r,n){this._q=e,this._parse=t,this._timeout=r,this._initial=!0,this._remoteValue=!1,this._fRef="string"==typeof n?new Firebase(n):n}angular.module("firebase",[]).value("Firebase",Firebase),angular.module("firebase").factory("angularFire",["$q","$parse","$timeout",function(e,t,r){return function(n,i,a){var o=new AngularFire(e,t,r,n);return o.associate(i,a)}}]),AngularFire.prototype={associate:function(e,t){var r=this,n=this._q.defer(),i=n.promise;return this._fRef.on("value",function(i){var a=!1;if(n&&(a=n,n=!1),i&&void 0!==i.val()){var o=i.val();if(r._remoteValue=angular.copy(o),angular.equals(o,r._parse(t)(e)))return}r._timeout(function(){r._resolve(e,t,a,r._remoteValue)})}),i},disassociate:function(){var e=this;e._unregister&&e._unregister(),this._fRef.off("value")},_resolve:function(e,t,r,n){var i=this;if(null===n){var a=e[t];if("object"==typeof a){var o=Object.prototype.toString;n=o.call(a)==o.call([])?[]:{}}}this._parse(t).assign(e,angular.copy(n)),this._remoteValue=angular.copy(n),r&&(r.resolve(function(){i.disassociate()}),this._watch(e,t))},_watch:function(e,t){var r=this;r._unregister=e.$watch(t,function(){if(r._initial)return r._initial=!1,void 0;var n=JSON.parse(angular.toJson(r._parse(t)(e)));angular.equals(n,r._remoteValue)||r._fRef.ref().set(n)},!0),e.$on("$destroy",function(){r.disassociate()})},_log:function(e){console&&console.log&&console.log(e)}},angular.module("firebase").factory("angularFireCollection",["$timeout",function(e){return function(t,r){function n(e,t){this.$ref=e.ref(),this.$id=e.name(),this.$index=t,angular.extend(this,{$priority:e.getPriority()},e.val())}function i(e){return e?h[e]+1:0}function a(e,t){h[t.$id]=e,d.splice(e,0,t)}function o(e){var t=h[e];d.splice(t,1),h[e]=void 0}function u(e,t){d[e]=t}function s(e,t,r){d.splice(e,1),d.splice(t,0,r),c(e,t)}function c(e,t){var r=d.length;t=t||r,t>r&&(t=r);for(var n=e;t>n;n++){var i=d[n];i.$index=h[i.$id]=n}}var l,f=[function(e){return null==e.$priority?0:angular.isNumber(e.$priority)?1:angular.isString(e.$priority)?2:void 0},function(e){return e.$priority?e.$priority:1/0},function(e){return e.$id}],h={},d=[];return l="string"==typeof t?new Firebase(t):t,r&&"function"==typeof r&&l.once("value",r),l.on("child_added",function(t,r){e(function(){var e=i(r);a(e,new n(t,e)),c(e)})}),l.on("child_removed",function(t){e(function(){var e=t.name(),r=h[e];o(e),c(r)})}),l.on("child_changed",function(t,r){e(function(){var e=h[t.name()],a=i(r),o=new n(t,e);u(e,o),a!==e&&s(e,a,o)})}),l.on("child_moved",function(t,r){e(function(){var e=h[t.name()],n=i(r),a=d[e];s(e,n,a)})}),d.getByName=function(e){return d[h[e]]},d.add=function(e,t){var r;return r=t?l.ref().push(e,t):l.ref().push(e)},d.remove=function(e,t){var r=angular.isString(e)?d[h[e]]:e;t?r.$ref.remove(t):r.$ref.remove()},d.update=function(e,t){var r=angular.isString(e)?d[h[e]]:e,n={};angular.forEach(r,function(e,t){0!==t.indexOf("$")&&(n[t]=e)}),t?r.$ref.set(n,t):r.$ref.set(n)},d.order=f,d}}]),angular.module("firebase").factory("angularFireAuth",["$rootScope","$parse","$timeout","$location","$route","$q",function(e,t,r,n,i,a){function o(e){var t=e.split(".");if(!t instanceof Array||3!==t.length)throw new Error("Invalid JWT");var r=t[1];return JSON.parse(decodeURIComponent(escape(window.atob(r))))}function u(e,n,i,a){n&&r(function(){t(n).assign(e,i),a()})}function s(e,t,r){e.authRequired&&!r._authenticated&&(r._redirectTo=void 0===e.pathTo?n.path():e.pathTo===t?"/":e.pathTo,n.replace(),n.path(t))}return{initialize:function(t,r){var n=this;if(r=r||{},this._scope=e,!r.scope)throw new Exception("Scope not provided to angularFireAuth!");if(this._scope=r.scope,!r.name)throw new Exception("Model name not provided to angularFireAuth!");if(this._name=r.name,this._cb=function(){},r.callback&&"function"==typeof r.callback&&(this._cb=r.callback),this._redirectTo=null,this._authenticated=!1,r.path&&(i.current&&s(i.current,r.path,n),e.$on("$routeChangeStart",function(e,t){s(t,r.path,n)})),this._ref=new Firebase(t),r.simple&&r.simple===!1)return u(this._scope,this._name,null),void 0;if(!window.FirebaseSimpleLogin){var a=new Error("FirebaseSimpleLogin undefined, did you include firebase-simple-login.js?");return e.$broadcast("angularFireAuth:error",a),void 0}var o=new FirebaseSimpleLogin(this._ref,function(t,r){n._cb(t,r),t?e.$broadcast("angularFireAuth:error",t):r?n._loggedIn(r):n._loggedOut()});this._authClient=o},login:function(t,r){var n=this._watchForLogin();switch(t){case"github":case"persona":case"twitter":case"facebook":case"password":if(this._authClient)this._authClient.login(t,r);else{var i=new Error("Simple Login not initialized");e.$broadcast("angularFireAuth:error",i)}break;default:var a,u=this;try{a=o(t),this._ref.auth(t,function(t){t?e.$broadcast("angularFireAuth:error",t):u._loggedIn(a)})}catch(s){e.$broadcast("angularFireAuth:error",s)}}return n},createUser:function(t,n,i,a){var o=this;this._authClient.createUser(t,n,function(u,s){try{u?e.$broadcast("angularFireAuth:error",u):a||o.login("password",{email:t,password:n})}catch(c){e.$broadcast("angularFireAuth:error",c)}i&&r(function(){i(s)})})},logout:function(){this._authClient?this._authClient.logout():(this._ref.unauth(),this._loggedOut())},_loggedIn:function(t){var r=this;this._authenticated=!0,u(this._scope,this._name,t,function(){e.$broadcast("angularFireAuth:login",t),r._redirectTo&&(n.replace(),n.path(r._redirectTo),r._redirectTo=null)})},_loggedOut:function(){this._authenticated=!1,u(this._scope,this._name,null,function(){e.$broadcast("angularFireAuth:logout")})},_watchForLogin:function(){function t(e,t){r(function(){e?i.reject(e):i.resolve(t)});for(var a=0;a<n.length;a++)n[a]()}var n=[],i=a.defer();return n.push(e.$on("angularFireAuth:login",function(e,r){t(null,r)})),n.push(e.$on("angularFireAuth:error",function(e,r){t(r,null)})),i.promise}}}]);