<!doctype html>
<html lang="en" ng-app="chat">
<head>
  <meta charset="UTF-8">
  <title>AngularFire Chat Demo</title>
  <link rel="stylesheet" type="text/css" href="https://www.firebase.com/css/example.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.1.3/angular.min.js"></script>
  <script src="https://cdn.firebase.com/v0/firebase.js"></script>
  <script src="../angularFire.js"></script>
</head>
<body ng-controller="Chat">
  <div>
    <label for="">Your name: </label><input id="name" type="text" ng-model="username">
  </div>
  <p></p>
  <div id="messagesDiv" auto-scroll="messages" style="height:500px;">
    <div ng-cloak ng-repeat="message in messages">
      <em>{{message.from}}: </em>{{message.content}}
    </div>
  </div>
  <form ng-submit="addMessage()">
    <input id="message" type="text" ng-model="message" placeholder="Message...">
    <input id="send" type="submit" id="submit" value="Send" style="font-size:24px;">
  </form>
  <script type="text/javascript">
    var testModule;
    var chatModule = angular.module("chat", ["firebase"]);
    function Chat($scope, angularFireCollection) {
      var url = 'https://angularFire.firebaseio-demo.com/chat';
      $scope.messages = angularFireCollection(new Firebase(url).limit(50));
      $scope.username = 'Guest' + Math.floor(Math.random()*101);
      $scope.addMessage = function() {
        $scope.messages.add({from: $scope.username, content: $scope.message});
        $scope.message = "";
      }
      testModule = new TestModule($scope);
    }

    function TestModule(scope) {
      this._scope = scope;
    }
    TestModule.prototype.addMessage = function(from, msg) {
      this._scope.username = from;
      this._scope.message = msg;
      this._scope.addMessage();
    };
  </script>
</body>
</html>
